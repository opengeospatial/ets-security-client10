<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2021-01-29 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20210129" />
    <meta http-equiv="Content-Language" content="en" />
    <title>OGC Web Service Security Client (OGC-17-007) Conformance Test Suite &#x2013; TEAM Engine Setup Instructions</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://cite.opengeospatial.org/" id="bannerLeft">
                                                                                                <img src="./img/ogc-logo.png"  alt="OGC Web Service Security Client (OGC-17-007) Conformance Test Suite"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2021-01-29
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.6
                      </li>
                      
              
      
                                    
    <li class="pull-right">
                      <a href="https://github.com/opengeospatial/ets-security-client10/issues" class="externalLink" title="Issues">
        Issues</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Getting Started</li>
                              
      <li>
  
                          <a href="index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="client_setup.html" title="Client Setup">
          <span class="none"></span>
        Client Setup</a>
            </li>
                
      <li>
  
                          <a href="saml2.html" title="SAML2 Testing">
          <span class="none"></span>
        SAML2 Testing</a>
            </li>
                
      <li>
  
                          <a href="test_suite.html" title="Test Suite">
          <span class="none"></span>
        Test Suite</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>TEAM Engine Setup</a>
          </li>
                
      <li>
  
                          <a href="ca_cert_setup.html" title="CA Cert Setup">
          <span class="none"></span>
        CA Cert Setup</a>
            </li>
                
      <li>
  
                          <a href="changelog.html" title="Release Notes">
          <span class="none"></span>
        Release Notes</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                  
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>TEAM Engine Setup Instructions</h1>
<p>These instructions are for system administrators and test users who want to deploy their own instance of TEAM Engine on their own infrastructure, and use this ETS. There are a few extra steps required to use this ETS compared to other standard test suites provided by OGC.</p>
<div class="section">
<h2><a name="Software_Environment"></a>Software Environment</h2>
<p>This guide assumes you are using this specific set of hosting software. Some minor version changes may work, although they are not guaranteed.</p>

<ul>
  
<li>OpenJDK JRE 8 or Oracle JRE 8</li>
  
<li>Tomcat 7</li>
  
<li>TEAM Engine v5.3</li>
  
<li>ETS Security Client 1.0 (latest release)</li>
  
<li>Git</li>
  
<li>Maven 3</li>
</ul>
<p>This guide will be using <a class="externalLink" href="https://www.debian.org/releases/">Debian Stretch</a> as the operating system. It should work with minor changes for other Linux distributions or for BSD/MacOS systems. For Windows, I recommend following the <a class="externalLink" href="https://github.com/opengeospatial/teamengine/blob/master/doc/en/index.rst">official TEAM Engine guide</a> and then using this guide for deploying the ETS.</p></div>
<div class="section">
<h2><a name="a1._Install_Java"></a>1. Install Java</h2>
<p>OpenJDK is available in most Linux package managers; Oracle JDK must be manually downloaded from Oracle and installed using their instructions.</p>
<p>For OpenJDK:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt update
$ sudo apt install openjdk-8-jdk-headless
$ java -version
openjdk version &quot;1.8.0_181&quot;
OpenJDK Runtime Environment (build 1.8.0_181-8u181-b13-1~deb9u1-b13)
OpenJDK 64-Bit Server VM (build 25.181-b13, mixed mode)
$ javac -version
javac 1.8.0_181
</pre></div></div></div>
<div class="section">
<h2><a name="a2._Configure_JAVA_HOME"></a>2. Configure JAVA_HOME</h2>
<p>It is important to have the location of the Java home directory configured for various apps, including Tomcat.</p>
<p>By default on Debian, the java directory is located at <tt>/usr/lib/jvm/java-8-openjdk-amd64</tt>. This may vary on your OS.</p>
<p>To set the environment variable, add the following line to the end of <tt>/etc/profile</tt>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">export JAVA_HOME=&quot;/usr/lib/jvm/java-8-openjdk-amd64&quot;
</pre></div></div>
<p>After reloading your shell session, you should be able to check the environment variable:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ echo $JAVA_HOME
/usr/lib/jvm/java-8-openjdk-amd64
</pre></div></div></div>
<div class="section">
<h2><a name="a3._Install_Maven"></a>3. Install Maven</h2>
<p>Maven 3 is available in the Debian apt repository.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt install maven
$ mvn -version
Apache Maven 3.3.9
Maven home: /usr/share/maven
Java version: 1.8.0_181, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-8-openjdk-amd64/jre
Default locale: en_US, platform encoding: ANSI_X3.4-1968
OS name: &quot;linux&quot;, version: &quot;4.9.93-linuxkit-aufs&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;
</pre></div></div></div>
<div class="section">
<h2><a name="a4._Install_Git"></a>4. Install Git</h2>
<p>Git is available in the Debian apt repository.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt install git
$ git --version
git version 2.11.0
</pre></div></div></div>
<div class="section">
<h2><a name="a5._Install_Tomcat_7"></a>5. Install Tomcat 7</h2>
<p>Tomcat 7 is not available in the apt repository (only version 8), so we will download and install from source instead. Find the latest <tt>tar.gz</tt> files from the <a class="externalLink" href="https://tomcat.apache.org/download-70.cgi">Tomcat Download page</a>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt install wget
$ cd /tmp
$ wget http://muug.ca/mirror/apache-dist/tomcat/tomcat-7/v7.0.91/bin/apache-tomcat-7.0.91.tar.gz
$ wget https://www.apache.org/dist/tomcat/tomcat-7/v7.0.91/bin/apache-tomcat-7.0.91.tar.gz.sha512
$ sha512sum -c apache-tomcat-7.0.91.tar.gz.sha512
apache-tomcat-7.0.91.tar.gz: OK
</pre></div></div>
<p>Note: That last line MUST print OK; if it does not, then your Tomcat download may be invalid or has been tampered with.</p>
<p>Also install Tomcat native, for additional OS support:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt install libtcnative-1
</pre></div></div>
<p>Next is installing Tomcat to <tt>/opt</tt>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ tar xzvf apache-tomcat-7.0.91.tar.gz
$ sudo cp -r apache-tomcat-7.0.91 /opt/tomcat7
</pre></div></div>
<p>Install an init script to auto-start and stop the server, using <tt>src/site/resources/tomcat.sh</tt> as the source, to <tt>/etc/init.d/tomcat</tt>. It contains modifications for including the TEAM Engine base directory as a JVM option.</p>
<p>The init script should be executable:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo chmod +x /etc/init.d/tomcat
</pre></div></div>
<p>Create a user/group for Tomcat:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ adduser tomcat --home /opt/tomcat7 --no-create-home --system --group
</pre></div></div>
<p>And modify the permissions of the Tomcat directory for the Tomcat user:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo chown -R tomcat:tomcat /opt/tomcat7
</pre></div></div>
<p>You can try running Tomcat and see if it works in your browser:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo service tomcat start
</pre></div></div>
<p>It should be available at <a class="externalLink" href="http://host:8080/">http://host:8080/</a>, where <tt>host</tt> is the IP of the machine running Debian.</p></div>
<div class="section">
<h2><a name="a6._Download_TEAM_Engine_Source"></a>6. Download TEAM Engine Source</h2>
<p>The source for <a class="externalLink" href="https://github.com/opengeospatial/teamengine">TEAM Engine is available on GitHub</a>. We will use Git to get version 5.3. We will only clone enough code to get that release tag.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ cd $HOME
$ git clone --branch 5.3 --depth 1 https://github.com/opengeospatial/teamengine.git
</pre></div></div>
<p>Next build the source to generate the packages for Tomcat.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ cd $HOME/teamengine
$ mvn install
</pre></div></div></div>
<div class="section">
<h2><a name="a7._Setup_of_TEAM_Engine_Base_Directory"></a>7. Setup of TEAM Engine Base Directory</h2>
<p>A base directory must be set up for TEAM Engine to contain the setup scripts for the test suites.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo apt install unzip
$ sudo mkdir /opt/te_base
$ sudo unzip teamengine-console/target/teamengine-console-5.3-base.zip -d /opt/te_base
$ sudo chown -R tomcat:tomcat /opt/te_base
</pre></div></div></div>
<div class="section">
<h2><a name="a8._Deploy_TEAM_Engine_to_Tomcat"></a>8. Deploy TEAM Engine to Tomcat</h2>
<p>First install the libraries for Tomcat:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo unzip teamengine-web/target/teamengine-common-libs.zip -d /opt/tomcat7/lib
</pre></div></div>
<p>Then we install the WAR file to Tomcat&#x2019;s webapps:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo cp teamengine-web/target/teamengine.war /opt/tomcat7/webapps/.
</pre></div></div>
<p>Tomcat, if running, will automatically extract the WAR file. If Tomcat is not running, start it with the service command:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo service tomcat start
</pre></div></div></div>
<div class="section">
<h2><a name="a9._Download_ETS_Source"></a>9. Download ETS Source</h2>
<p>Use git to download the latest source for the test suite:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ cd $HOME
$ git clone https://github.com/opengeospatial/ets-security-client10
</pre></div></div>
<p>And compile:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ cd ets-security-client10
$ mvn install
</pre></div></div></div>
<div class="section">
<h2><a name="a10._Deploy_ETS_to_TEAM_Engine"></a>10. Deploy ETS to TEAM Engine</h2>
<p>The control scripts and sample files need to be installed to the base directory of TEAM Engine.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ cd $HOME/ets-security-client10
$ sudo unzip target/ets-security-client10-0.2-SNAPSHOT-ctl.zip -d /opt/te_base/scripts
</pre></div></div>
<p>Additionally, copy the sample Java Keystore to the TE Base so we can reference it in test sessions. If you have your own keystore, then skip this step.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo cp src/main/resources/security.jks /opt/te_base/ets-security-client10.jks
$ sudo chown -R tomcat:tomcat /opt/te_base
</pre></div></div>
<p>Next, install the dependent libraries.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ sudo unzip target/ets-security-client10-0.2-SNAPSHOT-deps.zip -d /opt/tomcat7/webapps/teamengine/WEB-INF/lib
$ sudo chown -R tomcat:tomcat /opt/tomcat7/webapps/teamengine/WEB-INF/lib
</pre></div></div>
<p>Finally, the system administrator <b>must</b> customize the CTL script for their installation. It is located at <tt>/opt/te_base/scripts/security-client10/1.0/ctl/security-client10-suite.ctl</tt>. In this file, you will have to scroll down to the <tt>&lt;xsl:variable&gt;</tt> elements, and edit the <tt>address</tt>, <tt>port</tt>, <tt>host</tt>, <tt>jks_path</tt>, and <tt>jks_password</tt> parameters.</p>
<p>You will probably want the <tt>address</tt> parameter to be <tt>0.0.0.0</tt> or a specific IP if you want this test server to be accessible outside of the current machine.</p>
<p>The <tt>port</tt> should not conflict with any other services running on the machine.</p>
<p>The <tt>host</tt> should be resolvable by the secure clients.</p>
<p>The <tt>jks_path</tt> should point to either your own Java Keystore, or the sample keystore from this ETS.</p>
<p>The <tt>jks_password</tt> is required for the test server to unlock the keystore.</p>
<p>These settings will apply to all test sessions ran by this TEAM Engine instance. While a test user may normally edit these values when running the ETS as a JAR or inside an IDE, a test user should not have access to these parameters inside TEAM Engine; being able to edit the values remotely could pose a security risk.</p></div>
<div class="section">
<h2><a name="a11._Run_ETS"></a>11. Run ETS</h2>
<p>The ETS should now be installed in TEAM Engine, and you should be able to create a new test session for Security Client 1.0.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2021
                        <a href="http://www.opengeospatial.org/">Open Geospatial Consortium</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>