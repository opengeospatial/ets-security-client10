<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2021-01-29 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20210129" />
    <meta http-equiv="Content-Language" content="en" />
    <title>OGC Web Service Security Client (OGC-17-007) Conformance Test Suite &#x2013; Secure Client Setup Instructions</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://cite.opengeospatial.org/" id="bannerLeft">
                                                                                                <img src="./img/ogc-logo.png"  alt="OGC Web Service Security Client (OGC-17-007) Conformance Test Suite"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2021-01-29
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.6
                      </li>
                      
              
      
                                    
    <li class="pull-right">
                      <a href="https://github.com/opengeospatial/ets-security-client10/issues" class="externalLink" title="Issues">
        Issues</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Getting Started</li>
                              
      <li>
  
                          <a href="index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Client Setup</a>
          </li>
                
      <li>
  
                          <a href="saml2.html" title="SAML2 Testing">
          <span class="none"></span>
        SAML2 Testing</a>
            </li>
                
      <li>
  
                          <a href="test_suite.html" title="Test Suite">
          <span class="none"></span>
        Test Suite</a>
            </li>
                
      <li>
  
                          <a href="team_setup.html" title="TEAM Engine Setup">
          <span class="none"></span>
        TEAM Engine Setup</a>
            </li>
                
      <li>
  
                          <a href="ca_cert_setup.html" title="CA Cert Setup">
          <span class="none"></span>
        CA Cert Setup</a>
            </li>
                
      <li>
  
                          <a href="changelog.html" title="Release Notes">
          <span class="none"></span>
        Release Notes</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                  
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Secure Client Setup Instructions</h1>
<p>This document will cover how you should configure your secure client to connect to the test harness.</p>
<p>For all usages (IDE, JAR, TEAM Engine), a test endpoint URL of the following format should be generated for your test run:</p>

<div class="source">
<div class="source"><pre class="prettyprint">https://host:port/uniquenonce
</pre></div></div>
<p>The unique nonce is a random string of characters that should prevent your test session endpoint from potentially conflicting with another concurrent test session.</p>
<div class="section">
<h2><a name="cURL"></a>cURL</h2>
<p><a class="externalLink" href="https://curl.haxx.se">cURL</a> is a command line client for URL protocols such as HTTP and HTTPS. It can work as a very simple and barely capable secure test client, as it can make HTTP and HTTPS connections to download a capabilities document. It cannot interpret that document or make subsequent automatic requests.</p>
<p>In the following examples I will use these command line parameters:</p>

<ul>
  
<li><tt>-i</tt>
  
<ul>
    
<li>Includes the response headers from the Test Server in the output</li>
  </ul></li>
  
<li><tt>-k</tt>
  
<ul>
    
<li>Disables certificate verification, necessary to accept a self-signed certificate</li>
  </ul></li>
</ul>
<div class="section">
<h3><a name="Making_an_HTTPS_Request"></a>Making an HTTPS Request</h3>
<p>Example with IDE Test Server emulating WMS 1.1.1:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ curl -ik https://127.0.0.1:10080/6iwyg0phykqnt7mw
HTTP/1.1 404 Not Found
Date: Mon, 10 Sep 2018 05:19:31 GMT
Content-Type: application/vnd.ogc.se_xml;charset=iso-8859-1
Content-Length: 272
Server: Jetty(9.4.11.v20180605)

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE ServiceExceptionReport
  SYSTEM &quot;http://schemas.opengis.net/wms/1.1.1/exception_1_1_1.dtd&quot;&gt;
&lt;ServiceExceptionReport version=&quot;1.1.1&quot;&gt;
  &lt;ServiceException&gt;Invalid query parameters&lt;/ServiceException&gt;
&lt;/ServiceExceptionReport&gt;
</pre></div></div>
<p>In the above case, cURL was able to connect to the server over HTTPS. As no query parameters were used, the test server returns a Service Exception.</p></div>
<div class="section">
<h3><a name="Making_an_HTTP_Request"></a>Making an HTTP Request</h3>
<p>Example with IDE Test Server emulating WMS 1.1.1:</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ curl -i http://127.0.0.1:10080/6iwyg0phykqnt7mw
HTTP/1.1 404 Not Found
Date: Mon, 10 Sep 2018 05:31:35 GMT
Content-Type: application/vnd.ogc.se_xml;charset=iso-8859-1
Content-Length: 272
Server: Jetty(9.4.11.v20180605)

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE ServiceExceptionReport
  SYSTEM &quot;http://schemas.opengis.net/wms/1.1.1/exception_1_1_1.dtd&quot;&gt;
&lt;ServiceExceptionReport version=&quot;1.1.1&quot;&gt;
   &lt;ServiceException&gt;Invalid query parameters&lt;/ServiceException&gt;
&lt;/ServiceExceptionReport&gt;
</pre></div></div>
<p>Here the &#x201c;https&#x201d; in the url has been replaced with &#x201c;http&#x201d;, which makes cURL open an HTTP connection without TLS. The server responds with a Service Exception due to the missing parameters.</p>
<p>From a client perspective, this is identical to the HTTPS example. However the test suite will recognize the connection does not use HTTPS and can execute custom tests accordingly.</p></div>
<div class="section">
<h3><a name="Making_an_HTTPS_Request_with_valid_parameters"></a>Making an HTTPS Request with valid parameters</h3>
<p>Example with IDE Test Server emulating WMS 1.1.1. Note that some URL characters have been escaped for the Bash shell.</p>

<div class="source">
<div class="source"><pre class="prettyprint">$ curl -ik https://127.0.0.1:10080/o1zd1z39oemgxpv8\?request\=GetCapabilities\&amp;service\=WMS
HTTP/1.1 200 OK
Date: Mon, 10 Sep 2018 05:34:50 GMT
Content-Type: application/vnd.ogc.wms_xml;charset=iso-8859-1
Content-Length: 1986
Server: Jetty(9.4.11.v20180605)

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE WMT_MS_Capabilities
  SYSTEM &quot;http://schemas.opengis.net/wms/1.1.1/capabilities_1_1_1.dtd&quot;&gt;
&lt;WMT_MS_Capabilities version=&quot;1.1.1&quot;&gt;
   &lt;Service&gt;
      &lt;Name&gt;ets-security-client-10-wms-111&lt;/Name&gt;
      &lt;Title&gt;ETS Security Client 1.0 WMS 1.1.1&lt;/Title&gt;
      &lt;Abstract&gt;WMS 1.1.1 for validating secure client requests under ETS Security Client 1.0&lt;/Abstract&gt;
      &lt;OnlineResource xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
                      xlink:href=&quot;https://127.0.0.1:10080/o1zd1z39oemgxpv8&quot;
                      xlink:type=&quot;simple&quot;/&gt;
   &lt;/Service&gt;
   &lt;Capability&gt;
      &lt;Request&gt;
         &lt;GetCapabilities&gt;
            &lt;Format&gt;application/vnd.ogc.wms_xml&lt;/Format&gt;
            &lt;DCPType&gt;
               &lt;HTTP&gt;
                  &lt;Get&gt;
                     &lt;OnlineResource xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
                                     xlink:href=&quot;https://127.0.0.1:10080/o1zd1z39oemgxpv8&quot;
                                     xlink:type=&quot;simple&quot;/&gt;
                  &lt;/Get&gt;
                  &lt;Post&gt;
                     &lt;OnlineResource xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
                                     xlink:href=&quot;https://127.0.0.1:10080/o1zd1z39oemgxpv8&quot;
                                     xlink:type=&quot;simple&quot;/&gt;
                  &lt;/Post&gt;
               &lt;/HTTP&gt;
            &lt;/DCPType&gt;
         &lt;/GetCapabilities&gt;
         &lt;GetMap&gt;
            &lt;Format&gt;image/png&lt;/Format&gt;
            &lt;DCPType&gt;
               &lt;HTTP&gt;
                  &lt;Get&gt;
                     &lt;OnlineResource xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
                                     xlink:href=&quot;https://127.0.0.1:10080/o1zd1z39oemgxpv8&quot;
                                     xlink:type=&quot;simple&quot;/&gt;
                  &lt;/Get&gt;
               &lt;/HTTP&gt;
            &lt;/DCPType&gt;
         &lt;/GetMap&gt;
      &lt;/Request&gt;
      &lt;Exception&gt;
         &lt;Format&gt;application/vnd.ogc.se_xml&lt;/Format&gt;
      &lt;/Exception&gt;
   &lt;/Capability&gt;
&lt;/WMT_MS_Capabilities&gt;
</pre></div></div>
<p>As the query parameters are correct, a Capabilities document is returned to the secure client.</p></div></div>
<div class="section">
<h2><a name="QGIS_3"></a>QGIS 3</h2>
<p><a class="externalLink" href="https://qgis.org/">QGIS</a> is a free and open source GIS application. It is available for multiple platforms, making it an accessible GIS tool with a common user experience.</p>
<p>QGIS is a part of the <a class="externalLink" href="https://www.osgeo.org">Open Source Geospatial Foundation</a>.</p>
<p>In the following examples I will show how to add the ETS Test Server to QGIS as a remote service.</p>
<div class="section">
<h3><a name="WMS_1.1.1_and_HTTP"></a>WMS 1.1.1 and HTTP</h3>
<p>With the ETS set up such that it emulates a WMS 1.1.1 service, start a test session and it will generate a unique URL. Note that the Test Service will wait 5 minutes (300 seconds) for a secure client connection, so you do not need to be overly rushed to enter the details and start the test.</p>
<p>In QGIS, go to the &#x201c;Layer&#x201d; menu, &#x201c;Add Layer&#x201d;, and select &#x201c;Add WMS/WMTS Layer&#x2026;&#x201d;. Click the &#x201c;New&#x201d; button to create a new connection, and fill in the following details.</p>
<p><b>Name</b>: CITE Security Client 1.0<br /><b>URL</b>: &lt;URL for your test session, using <tt>http</tt> instead of <tt>https</tt>&gt;<br /><b>Authentication Configurations</b>: No authentication<br /><b>Referer</b>: &lt;Leave Blank&gt;<br /><b>DPI-Mode</b>: all </p>
<p>Leave the remaining checkboxes at their defaults, which should be &#x201c;blank&#x201d;. Click &#x201c;OK&#x201d; to save the connection.</p>
<p>To start the test session, ensure the &#x201c;CITE Security Client 1.0&#x201d; is selected in the drop-down select box, and click &#x201c;Connect&#x201d;.</p>
<p>QGIS will try to retrieve the Capabilities document from the Test Server, triggering the ETS servlets and capturing the request. QGIS will display no layers in the list for the Test Server, as none are advertised.</p>
<p>The ETS should now have finished the test session, and the results can be viewed in the TestNG file or TEAM Engine.</p>
<p>For future test sessions, you can edit the &#x201c;CITE Security Client 1.0&#x201d; connection that is saved in QGIS, and change the URL to your new test session endpoint.</p></div>
<div class="section">
<h3><a name="WMS_1.1.1_and_HTTPS"></a>WMS 1.1.1 and HTTPS</h3>
<p>The instructions are identical to the HTTP-only instructions, except you will use <tt>https</tt> in the URL scheme instead of <tt>http</tt>.</p>
<p>When you click &#x201c;Connect&#x201d;, a warning dialog will pop up about potential certificate problems, especially if you are using a self-signed certificate. In this case you can ignore them and continue the test, as it is your own certificate.</p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2021
                        <a href="http://www.opengeospatial.org/">Open Geospatial Consortium</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>